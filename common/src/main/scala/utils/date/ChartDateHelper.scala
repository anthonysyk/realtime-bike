package utils.date

import java.text.SimpleDateFormat
import java.util.{Locale, TimeZone}

import io.circe.parser._
import models.{Station, WindowStation}

object ChartDateHelper {

  val TIMEZONE: TimeZone = java.util.TimeZone.getTimeZone("ECT")
  val humanReadableDate = new SimpleDateFormat("EEEE dd HH:mm", Locale.FRENCH)
  val humanReadableDateWithoutTime = new SimpleDateFormat("EEEE", Locale.FRENCH)
  val date = new SimpleDateFormat("dd-MM")
  val time = new SimpleDateFormat("HH:mm")
  val datetime = new SimpleDateFormat("dd-MM HH:mm")
  time.setTimeZone(TIMEZONE)
  date.setTimeZone(TIMEZONE)
  datetime.setTimeZone(TIMEZONE)
  humanReadableDate.setTimeZone(TIMEZONE)
  humanReadableDateWithoutTime.setTimeZone(TIMEZONE)

  def createLabel(timestamps: Seq[Long]): Seq[String] = {
    timestamps.foldLeft(Option.empty[Long] -> Seq.empty[String]) { (leftAcc, right) =>
      leftAcc match {
        case (None, acc) =>
          Option(right) -> (acc :+ humanReadableDate.format(right).capitalize)
        case (Some(previousDate), acc) if date.format(right) == date.format(previousDate) =>
          Some(right) -> (acc :+ time.format(right))
        case (Some(previousDate), acc) if date.format(right) != date.format(previousDate) =>
          Some(right) -> (acc.dropRight(1) :+ humanReadableDate.format(previousDate).capitalize :+ humanReadableDate.format(right).capitalize)
      }
    }
  }._2

  def main(args: Array[String]): Unit = {
    import versatile.json.CirceHelper._
    val data = """[{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":14,"available_bikes":13,"last_update":1538916855000,"state":{"start_date":"07-10-2018 13:53:31","last_update":"07-10-2018 14:54:15","bikes_taken":0,"bikes_droped":1,"availability":56.666666666666664,"counter":60,"counterStateChanged":9}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":13,"available_bikes":14,"last_update":1538920607000,"state":{"start_date":"07-10-2018 14:54:15","last_update":"07-10-2018 15:56:47","bikes_taken":-1,"bikes_droped":1,"availability":53.33333333333333,"counter":60,"counterStateChanged":10}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":11,"available_bikes":16,"last_update":1538923952000,"state":{"start_date":"07-10-2018 15:56:47","last_update":"07-10-2018 16:52:32","bikes_taken":0,"bikes_droped":1,"availability":46.666666666666664,"counter":60,"counterStateChanged":8}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":13,"available_bikes":14,"last_update":1538927802000,"state":{"start_date":"07-10-2018 16:52:32","last_update":"07-10-2018 17:56:42","bikes_taken":-1,"bikes_droped":0,"availability":53.33333333333333,"counter":60,"counterStateChanged":8}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":14,"available_bikes":13,"last_update":1538931266000,"state":{"start_date":"07-10-2018 17:56:42","last_update":"07-10-2018 18:54:26","bikes_taken":-1,"bikes_droped":1,"availability":56.666666666666664,"counter":60,"counterStateChanged":12}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":25,"available_bikes":2,"last_update":1538934982000,"state":{"start_date":"07-10-2018 18:54:26","last_update":"07-10-2018 19:56:22","bikes_taken":-1,"bikes_droped":1,"availability":100,"counter":60,"counterStateChanged":13}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":24,"available_bikes":3,"last_update":1538938509000,"state":{"start_date":"07-10-2018 19:56:22","last_update":"07-10-2018 20:55:09","bikes_taken":-1,"bikes_droped":2,"availability":100,"counter":60,"counterStateChanged":10}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538941817000,"state":{"start_date":"07-10-2018 20:55:09","last_update":"07-10-2018 21:50:17","bikes_taken":0,"bikes_droped":1,"availability":86.66666666666667,"counter":60,"counterStateChanged":7}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538945910000,"state":{"start_date":"07-10-2018 21:50:17","last_update":"07-10-2018 22:58:30","bikes_taken":-1,"bikes_droped":1,"availability":86.66666666666667,"counter":60,"counterStateChanged":9}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538948939000,"state":{"start_date":"07-10-2018 22:58:30","last_update":"07-10-2018 23:48:59","bikes_taken":0,"bikes_droped":0,"availability":86.66666666666667,"counter":60,"counterStateChanged":6}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538952573000,"state":{"start_date":"07-10-2018 23:59:04","last_update":"08-10-2018 00:49:33","bikes_taken":0,"bikes_droped":0,"availability":86.66666666666667,"counter":60,"counterStateChanged":6}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538956208000,"state":{"start_date":"08-10-2018 00:59:39","last_update":"08-10-2018 01:50:08","bikes_taken":0,"bikes_droped":0,"availability":86.66666666666667,"counter":60,"counterStateChanged":6}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538959842000,"state":{"start_date":"08-10-2018 01:50:08","last_update":"08-10-2018 02:50:42","bikes_taken":0,"bikes_droped":0,"availability":86.66666666666667,"counter":60,"counterStateChanged":7}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538963476000,"state":{"start_date":"08-10-2018 02:50:42","last_update":"08-10-2018 03:51:16","bikes_taken":0,"bikes_droped":0,"availability":86.66666666666667,"counter":59,"counterStateChanged":7}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538967110000,"state":{"start_date":"08-10-2018 03:51:16","last_update":"08-10-2018 04:51:50","bikes_taken":0,"bikes_droped":0,"availability":86.66666666666667,"counter":60,"counterStateChanged":7}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":23,"available_bikes":4,"last_update":1538970745000,"state":{"start_date":"08-10-2018 04:51:50","last_update":"08-10-2018 05:52:25","bikes_taken":0,"bikes_droped":0,"availability":86.66666666666667,"counter":60,"counterStateChanged":7}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":22,"available_bikes":5,"last_update":1538974616000,"state":{"start_date":"08-10-2018 05:52:25","last_update":"08-10-2018 06:56:56","bikes_taken":0,"bikes_droped":1,"availability":100,"counter":60,"counterStateChanged":8}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":0,"available_bikes":27,"last_update":1538978317000,"state":{"start_date":"08-10-2018 06:56:56","last_update":"08-10-2018 07:58:37","bikes_taken":-1,"bikes_droped":1,"availability":10,"counter":60,"counterStateChanged":24}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":0,"available_bikes":27,"last_update":1538981461000,"state":{"start_date":"08-10-2018 07:59:16","last_update":"08-10-2018 08:51:01","bikes_taken":-1,"bikes_droped":1,"availability":10,"counter":60,"counterStateChanged":7}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":0,"available_bikes":27,"last_update":1538985486000,"state":{"start_date":"08-10-2018 08:51:01","last_update":"08-10-2018 09:58:06","bikes_taken":-1,"bikes_droped":1,"availability":10,"counter":60,"counterStateChanged":9}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":1,"available_bikes":26,"last_update":1538988663000,"state":{"start_date":"08-10-2018 09:58:06","last_update":"08-10-2018 10:51:03","bikes_taken":-1,"bikes_droped":1,"availability":13.333333333333329,"counter":60,"counterStateChanged":13}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":18,"available_bikes":9,"last_update":1538992689000,"state":{"start_date":"08-10-2018 10:51:03","last_update":"08-10-2018 11:58:09","bikes_taken":-1,"bikes_droped":1,"availability":70,"counter":60,"counterStateChanged":19}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":24,"available_bikes":3,"last_update":1538996133000,"state":{"start_date":"08-10-2018 11:59:10","last_update":"08-10-2018 12:55:33","bikes_taken":-1,"bikes_droped":1,"availability":100,"counter":60,"counterStateChanged":21}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":9,"available_bikes":18,"last_update":1538999531000,"state":{"start_date":"08-10-2018 12:59:33","last_update":"08-10-2018 13:52:11","bikes_taken":-1,"bikes_droped":1,"availability":40,"counter":60,"counterStateChanged":21}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":7,"available_bikes":20,"last_update":1539002984000,"state":{"start_date":"08-10-2018 13:52:11","last_update":"08-10-2018 14:49:44","bikes_taken":-1,"bikes_droped":1,"availability":33.33333333333333,"counter":60,"counterStateChanged":10}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":14,"available_bikes":13,"last_update":1539007075000,"state":{"start_date":"08-10-2018 14:59:50","last_update":"08-10-2018 15:57:55","bikes_taken":-1,"bikes_droped":1,"availability":56.666666666666664,"counter":60,"counterStateChanged":12}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":19,"available_bikes":9,"last_update":1539010741000,"state":{"start_date":"08-10-2018 15:57:55","last_update":"08-10-2018 16:59:01","bikes_taken":-1,"bikes_droped":1,"availability":70,"counter":60,"counterStateChanged":19}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":28,"available_bikes":0,"last_update":1539014184000,"state":{"start_date":"08-10-2018 16:59:06","last_update":"08-10-2018 17:56:24","bikes_taken":-1,"bikes_droped":1,"availability":100,"counter":60,"counterStateChanged":17}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":27,"available_bikes":1,"last_update":1539017689000,"state":{"start_date":"08-10-2018 17:56:24","last_update":"08-10-2018 18:54:49","bikes_taken":-1,"bikes_droped":1,"availability":100,"counter":60,"counterStateChanged":10}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":25,"available_bikes":3,"last_update":1539021507000,"state":{"start_date":"08-10-2018 18:54:49","last_update":"08-10-2018 19:58:27","bikes_taken":-1,"bikes_droped":2,"availability":100,"counter":60,"counterStateChanged":10}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":28,"available_bikes":0,"last_update":1539024902000,"state":{"start_date":"08-10-2018 19:58:27","last_update":"08-10-2018 20:55:02","bikes_taken":-1,"bikes_droped":0,"availability":100,"counter":60,"counterStateChanged":8}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":27,"available_bikes":1,"last_update":1539028533000,"state":{"start_date":"08-10-2018 20:55:02","last_update":"08-10-2018 21:55:33","bikes_taken":0,"bikes_droped":1,"availability":100,"counter":60,"counterStateChanged":7}},{"number":10001,"name":"#10001 - IUT / FEYSSINE","address":"rue de la Technologie","position":{"lat":45.785632,"lng":4.882366},"banking":false,"bonus":false,"status":"OPEN","contract_name":"Lyon","bike_stands":30,"available_bike_stands":27,"available_bikes":1,"last_update":1539031534000,"state":{"start_date":"08-10-2018 21:55:33","last_update":"08-10-2018 22:45:34","bikes_taken":-1,"bikes_droped":1,"availability":100,"counter":50,"counterStateChanged":7}}]"""

  val data2 = """[{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":38,"available_bikes":2,"last_update_ts":1546638353699,"last_update":"04-01-2019 23:45:53","start_date":"","bikes_taken":0,"bikes_droped":0,"counter":1,"index":0,"label":"Vendredi 21:45"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":37,"available_bikes":3,"last_update_ts":1546640418019,"last_update":"05-01-2019 00:20:18","start_date":"05-01-2019 00:20:18","bikes_taken":0,"bikes_droped":1,"counter":2,"index":1,"label":"Vendredi 22:20"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":36,"available_bikes":4,"last_update_ts":1546644378033,"last_update":"05-01-2019 01:26:18","start_date":"","bikes_taken":0,"bikes_droped":0,"counter":1,"index":2,"label":"Vendredi 23:26"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":37,"available_bikes":3,"last_update_ts":1546646058046,"last_update":"05-01-2019 01:54:18","start_date":"05-01-2019 01:54:18","bikes_taken":2,"bikes_droped":0,"counter":3,"index":3,"label":"00:54"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":36,"available_bikes":4,"last_update_ts":1546676418006,"last_update":"05-01-2019 10:20:18","start_date":"","bikes_taken":0,"bikes_droped":0,"counter":1,"index":4,"label":"09:20"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":35,"available_bikes":5,"last_update_ts":1546679778069,"last_update":"05-01-2019 11:16:18","start_date":"05-01-2019 11:16:18","bikes_taken":1,"bikes_droped":1,"counter":3,"index":5,"label":"10:16"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":34,"available_bikes":6,"last_update_ts":1546681818064,"last_update":"05-01-2019 11:50:18","start_date":"05-01-2019 11:50:18","bikes_taken":0,"bikes_droped":2,"counter":2,"index":6,"label":"10:50"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":30,"available_bikes":10,"last_update_ts":1546683978051,"last_update":"05-01-2019 12:26:18","start_date":"05-01-2019 12:26:18","bikes_taken":0,"bikes_droped":3,"counter":3,"index":7,"label":"11:26"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":28,"available_bikes":12,"last_update_ts":1546687698031,"last_update":"05-01-2019 13:28:18","start_date":"05-01-2019 13:28:18","bikes_taken":1,"bikes_droped":2,"counter":3,"index":8,"label":"12:28"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":28,"available_bikes":12,"last_update_ts":1546689378084,"last_update":"05-01-2019 13:56:18","start_date":"05-01-2019 13:56:18","bikes_taken":1,"bikes_droped":0,"counter":2,"index":9,"label":"12:56"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":26,"available_bikes":14,"last_update_ts":1546690578011,"last_update":"05-01-2019 14:16:18","start_date":"05-01-2019 14:16:18","bikes_taken":2,"bikes_droped":0,"counter":2,"index":10,"label":"13:16"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":24,"available_bikes":16,"last_update_ts":1546692377977,"last_update":"05-01-2019 14:46:17","start_date":"05-01-2019 14:46:17","bikes_taken":2,"bikes_droped":5,"counter":6,"index":11,"label":"13:46"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":25,"available_bikes":15,"last_update_ts":1546694297960,"last_update":"05-01-2019 15:18:17","start_date":"","bikes_taken":0,"bikes_droped":0,"counter":1,"index":12,"label":"14:18"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":22,"available_bikes":18,"last_update_ts":1546696578056,"last_update":"05-01-2019 15:56:18","start_date":"05-01-2019 15:56:18","bikes_taken":1,"bikes_droped":3,"counter":5,"index":13,"label":"14:56"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":20,"available_bikes":20,"last_update_ts":1546698258050,"last_update":"05-01-2019 16:24:18","start_date":"05-01-2019 16:24:18","bikes_taken":1,"bikes_droped":2,"counter":3,"index":14,"label":"15:24"},{"externalId":"1020_Paris","name":"Cambon - Rivoli","available_bike_stands":13,"available_bikes":27,"last_update_ts":1546700298083,"last_update":"05-01-2019 16:58:18","start_date":"05-01-2019 16:58:18","bikes_taken":0,"bikes_droped":8,"counter":6,"index":15,"label":"15:58"}]"""

    val timestamps = parse(data).getRight.as[Seq[Station]].right.toOption.getOrElse(Nil)
      .map(_.last_update).sorted

    val timestamps2 = parse(data2).getRight.as[Seq[WindowStation]].right.toOption.getOrElse(Nil)
      .map(_.last_update_ts).sorted

    createLabel(timestamps2).foreach(println)
  }
}
